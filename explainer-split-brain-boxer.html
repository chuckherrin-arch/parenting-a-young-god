<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Split-Brain Boxer</title>
<style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
        font-family: Georgia, serif;
        background: #0a0a1a;
        color: #e0e0e0;
        min-height: 100vh;
        overflow-x: hidden;
    }
    .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 24px;
    }
    h1 {
        text-align: center;
        font-size: 1.8em;
        margin-bottom: 8px;
        color: #fff;
    }
    .subtitle {
        text-align: center;
        font-style: italic;
        color: #8888aa;
        margin-bottom: 40px;
        font-size: 1.05em;
    }
    canvas {
        display: block;
        margin: 0 auto;
        border-radius: 8px;
    }
    .controls {
        text-align: center;
        margin: 20px 0;
    }
    .controls button {
        background: #2c5f8a;
        color: #fff;
        border: none;
        padding: 12px 28px;
        font-size: 1em;
        font-family: Georgia, serif;
        border-radius: 5px;
        cursor: pointer;
        margin: 0 8px;
        transition: background 0.2s;
    }
    .controls button:hover { background: #3a7ab5; }
    .narration {
        text-align: center;
        font-size: 1.08em;
        line-height: 1.7;
        min-height: 100px;
        padding: 20px;
        color: #ccc;
        max-width: 680px;
        margin: 0 auto;
    }
    .narration em { color: #6fa8dc; }
    .narration .red { color: #e74c3c; }
    .narration .gold { color: #f0c040; }
    .phase-indicator {
        text-align: center;
        font-size: 0.85em;
        color: #666;
        margin-top: 10px;
        letter-spacing: 0.1em;
        text-transform: uppercase;
    }
    .stats {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin: 20px 0;
        font-size: 0.9em;
    }
    .stat {
        text-align: center;
        padding: 10px 20px;
        border: 1px solid #333;
        border-radius: 6px;
        min-width: 120px;
    }
    .stat .label { color: #888; font-size: 0.85em; margin-bottom: 4px; }
    .stat .value { font-size: 1.4em; font-weight: bold; }
    .stat .value.red { color: #e74c3c; }
    .stat .value.gold { color: #f0c040; }
    .stat .value.blue { color: #6fa8dc; }
    .moral {
        max-width: 650px;
        margin: 40px auto;
        text-align: center;
        font-size: 1.05em;
        line-height: 1.7;
        color: #aaa;
        border-top: 1px solid #333;
        padding-top: 30px;
    }
    .moral strong { color: #e0e0e0; }
    .footer-note {
        text-align: center;
        margin-top: 40px;
        font-size: 0.9em;
        color: #666;
        font-style: italic;
    }
    .footer-note a { color: #6fa8dc; }
    .analogy {
        max-width: 650px;
        margin: 0 auto 30px;
        font-size: 1.02em;
        line-height: 1.7;
        color: #bbb;
    }
    .analogy strong { color: #e0e0e0; }
    .analogy p { margin-bottom: 10px; }
    .analogy em { color: #ccc; }
</style>
</head>
<body>

<div class="container">
    <h1>The Split-Brain Boxer</h1>
    <p class="subtitle">A parable about zero-sum thinking, self-harm, and who profits from the fight</p>

    <div class="analogy">
    <p><strong>Here's an analogy:</strong></p>
    <p>A boxer has a disconnect in his brain — a severed corpus callosum (<a href="https://en.wikipedia.org/wiki/Split-brain" style="color:#6fa8dc">split-brain syndrome</a>). He only thinks of himself as "one side." He knows there's another side there, but doesn't feel like it's <em>him</em>.</p>
    <p>He lines up at a punching bag, and every time he throws a right hook, his left hand hits him in the face. He doesn't identify with the other side of himself, so he gets angry, and hits harder. Somebody keeps hitting him. He doesn't understand why, so he gets madder and madder, and his exercise routine means he gets stronger and stronger.</p>
    <p>As hard as he's punching, it just escalates to the limit of his power. Nobody's going to just get punched in the face forever.</p>
    <p>Eventually the fighter stops punching, and starts getting really serious. In the 1700's, the boxer had a rifle.</p>
    <p>Now add a promoter — someone who understands the boxer's biological limitation perfectly. He doesn't tell the boxer the truth. Instead, he tells him the "other side" is his enemy — because as long as the boxer keeps fighting himself, the promoter keeps collecting the prize money. Win/lose.</p>
    <p>The promoter knows what he's doing, so he built a shelter behind the ring, but the boxer got his hands on a nuke.</p>
    <p>Nobody wins.</p>
    </div>

    <canvas id="mainCanvas" width="700" height="450"></canvas>

    <div class="phase-indicator" id="phaseLabel">ROUND 1 OF 9</div>

    <div class="stats">
        <div class="stat">
            <div class="label">Boxer's Strength</div>
            <div class="value blue" id="strengthVal">100</div>
        </div>
        <div class="stat">
            <div class="label">Self-Damage</div>
            <div class="value red" id="damageVal">0</div>
        </div>
        <div class="stat">
            <div class="label">Promoter's Profit</div>
            <div class="value gold" id="profitVal">$0</div>
        </div>
    </div>

    <div class="narration" id="narration">
        Press <strong>Play</strong> to enter the ring.
    </div>

    <div class="controls">
        <button id="playBtn" onclick="startAnimation()">Play</button>
        <button onclick="resetAnimation()">Reset</button>
    </div>

    <div class="moral" id="moral" style="display:none">
        <p><strong>The boxer never understood why he kept getting hit.</strong></p>
        <p>He couldn't communicate with his other side. He knew it was there, but it didn't feel like <em>him</em>. That's not a choice — it's a biological limitation.</p>
        <p style="margin-top:16px"><strong>The promoter understood the limitation perfectly.</strong></p>
        <p>He didn't create the split. But he <em>exploited</em> it. He told the boxer the other side was his enemy — because <span class="gold">as long as the boxer kept fighting himself, the promoter kept collecting the purse.</span></p>
        <p style="margin-top:12px">Healing the split would have ended the fight. <em>And the fight was the product.</em></p>
        <p style="margin-top:16px"><strong>The promoter built a shelter.</strong> He thought he could survive the escalation he profited from. But the boxer got a nuke. <span class="red">At that scale, there is no shelter. Nobody wins.</span></p>
        <p style="margin-top:16px;color:#e0e0e0"><strong>The split-brain is a biological condition.<br>The exploitation of it is a business model.<br>The escalation has no ceiling.<br>We are the boxer. If this business model doesn't change, we are ALL going to die. Win/lose thinking and institutions are not sustainable on a planetary scale. The boxers shouldn't be abused, and there is no escalation ceiling. There will be no more boxers to exploit.</strong></p>
    </div>

    <p class="footer-note">
        A companion piece to <a href="https://globalracecondition.com">Parenting a Young God</a> by Chuck Herrin
    </p>
</div>

<script>
const canvas = document.getElementById('mainCanvas');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;

let running = false;
let animFrame = null;
let phase = 0;
let t = 0;
let strength = 100;
let damage = 0;
let profit = 0;
let punchFrame = -1;
let hitFlash = 0;
let knockedOut = false;

const phases = [
    {
        duration: 260,
        label: "ROUND 1 — THE DISCONNECT",
        narration: "A boxer steps into the ring. Strong. Determined. <em>But there's a limitation in his brain he doesn't know he has.</em> His corpus callosum is severed — he can't communicate with his left side. He doesn't experience it as <em>him</em>.",
        strengthGain: 0,
        punchPower: 10,
        punchInterval: 78,
        weapon: null
    },
    {
        duration: 286,
        label: "ROUND 2 — THE FIRST PUNCH",
        narration: "He throws a right hook at the bag. <em>His left fist hits him in the face.</em> He stumbles. Confused. <em>Who hit me?</em> He knows there's another side there. He just can't feel it as himself.",
        strengthGain: 5,
        punchPower: 15,
        punchInterval: 72,
        weapon: null
    },
    {
        duration: 312,
        label: "ROUND 3 — ESCALATION",
        narration: "As hard as he's punching, it just escalates to the limit of his power. <span class='red'>Nobody's going to just get punched in the face forever.</span> He gets madder and madder, stronger and stronger. The hits keep coming.",
        strengthGain: 10,
        punchPower: 25,
        punchInterval: 55,
        weapon: null
    },
    {
        duration: 338,
        label: "ROUND 4 — THE PROMOTER ARRIVES",
        narration: "A man in a fur coat appears ringside. He understands the boxer's condition perfectly — <em>and sees opportunity.</em> He leans in: <span class='gold'>\"That other hand? That's your enemy. He's trying to stop you from winning.\"</span>",
        strengthGain: 10,
        punchPower: 30,
        punchInterval: 52,
        weapon: null
    },
    {
        duration: 338,
        label: "ROUND 5 — THE LIE TAKES HOLD",
        narration: "The boxer believes him. It <em>feels</em> true — the left side does keep hitting him. The promoter whispers: <span class='gold'>\"Hit harder. Show him who's boss.\"</span> The harder the boxer swings, the more prize money the promoter collects. <span class='gold'>$10 per punch.</span>",
        strengthGain: 15,
        punchPower: 40,
        punchInterval: 45,
        weapon: null
    },
    {
        duration: 364,
        label: "ROUND 6 — THE FIGHTER GETS SERIOUS",
        narration: "Eventually the fighter stops just punching, and starts getting really serious. <span class='red'>In the 1700's, the boxer had a rifle.</span> The promoter books bigger venues. He never tells the boxer the truth — because <span class='gold'>the fight is the product.</span>",
        strengthGain: 20,
        punchPower: 55,
        punchInterval: 36,
        weapon: 'rifle'
    },
    {
        duration: 390,
        label: "ROUND 7 — THE BREAKING POINT",
        narration: "<span class='red'>His weapons are getting more powerful.</span> His left hand is destroying him. The promoter doesn't intervene. Why would he? <span class='gold'>Healing the split would end the revenue stream.</span> The boxer's disability isn't a problem to fix. <em>It's a business model.</em>",
        strengthGain: 25,
        punchPower: 70,
        punchInterval: 29,
        weapon: 'rifle'
    },
    {
        duration: 390,
        label: "ROUND 8 — THE SHELTER",
        narration: "The promoter knows what he's doing, so <span class='gold'>he built a shelter behind the ring.</span> He'll survive whatever happens. He keeps whispering: <span class='gold'>\"You're a champion. Don't stop now.\"</span> But the boxer got his hands on something much worse.",
        strengthGain: 15,
        punchPower: 85,
        punchInterval: 25,
        weapon: 'nuke'
    },
    {
        duration: 325,
        label: "ROUND 9 — NOBODY WINS",
        narration: "<span class='red'>The boxer got his hands on a nuke.</span> The promoter retreats to his shelter and shrugs. But it doesn't matter. <span class='red'>At this scale, nobody wins.</span> Not the boxer. Not the promoter. <em>Nobody.</em>",
        strengthGain: 0,
        punchPower: 100,
        punchInterval: 40,
        weapon: 'nuke'
    }
];

function lerp(a, b, t) { return a + (b - a) * t; }

function drawScene() {
    ctx.clearRect(0, 0, W, H);

    // Background - gym/ring
    ctx.fillStyle = '#111118';
    ctx.fillRect(0, 0, W, H);

    // Ring floor
    ctx.fillStyle = '#1a1520';
    ctx.fillRect(30, H * 0.65, W - 60, H * 0.35);

    // Ring ropes
    for (let i = 0; i < 3; i++) {
        const y = H * 0.35 + i * 35;
        ctx.beginPath();
        ctx.moveTo(30, y);
        ctx.lineTo(W - 30, y);
        ctx.strokeStyle = `rgba(200, 180, 160, ${0.15 + i * 0.05})`;
        ctx.lineWidth = 2;
        ctx.stroke();
    }

    const currentPhase = phases[phase];
    const progress = Math.min(1, t / currentPhase.duration);

    // Punching bag
    const bagX = 250;
    const bagY = H * 0.42;
    const bagSwing = punchFrame > 0 ? Math.sin(punchFrame * 0.3) * 8 * (punchFrame / 15) : 0;

    ctx.beginPath();
    ctx.moveTo(bagX, H * 0.15);
    ctx.lineTo(bagX + bagSwing * 0.5, bagY - 40);
    ctx.strokeStyle = '#555';
    ctx.lineWidth = 3;
    ctx.stroke();

    // Bag body
    ctx.beginPath();
    ctx.ellipse(bagX + bagSwing, bagY, 25, 50, 0, 0, Math.PI * 2);
    ctx.fillStyle = '#8B4513';
    ctx.fill();
    ctx.strokeStyle = '#6B3410';
    ctx.lineWidth = 2;
    ctx.stroke();

    // THE BOXER
    const boxerX = 380;
    const boxerY = H * 0.55;
    const boxerScale = 1 + (strength - 100) / 400; // Gets bigger with strength

    // Hit flash on boxer's face
    if (hitFlash > 0) {
        ctx.beginPath();
        ctx.arc(boxerX - 5, boxerY - 70 * boxerScale, 25 * boxerScale, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255, 50, 50, ${hitFlash * 0.4})`;
        ctx.fill();
        hitFlash -= 0.05;
    }

    if (knockedOut && progress > 0.5) {
        // Knocked out - on the ground
        drawKnockedOutBoxer(ctx, boxerX, boxerY + 30, boxerScale, progress);
    } else {
        drawBoxer(ctx, boxerX, boxerY, boxerScale, phase, t);
    }

    // THE PROMOTER (appears from phase 3 onwards)
    if (phase >= 3) {
        drawPromoter(ctx, W - 120, H * 0.5, phase, t, progress);
    }

    // Weapon indicator (phases 5+)
    const currentWeapon = phases[phase].weapon;
    if (currentWeapon) {
        drawWeapon(ctx, boxerX + 50, boxerY - 30, currentWeapon, t);
    }

    // Shelter (phase 7+)
    if (phase >= 7) {
        drawShelter(ctx, W - 120, H * 0.72, phase, t);
    }

    // Punch animation
    if (punchFrame > 0) {
        punchFrame--;
    }

    // Phase-specific punch logic
    if (!knockedOut && t % currentPhase.punchInterval === 0 && t > 0) {
        punchFrame = 15;
        hitFlash = 1.0;
        damage += currentPhase.punchPower;
        profit += 10;
        strength += Math.floor(currentPhase.strengthGain / (currentPhase.duration / currentPhase.punchInterval));

        document.getElementById('strengthVal').textContent = strength;
        document.getElementById('damageVal').textContent = damage;
        document.getElementById('profitVal').textContent = '$' + profit;

        // Check for knockout
        if (phase === 8 && damage > 400) {
            knockedOut = true;
        }
    }

    // Impact sparks
    if (punchFrame > 8) {
        const sparkX = boxerX - 15;
        const sparkY = boxerY - 65 * boxerScale;
        for (let i = 0; i < 5; i++) {
            const angle = Math.random() * Math.PI * 2;
            const dist = Math.random() * 20;
            ctx.beginPath();
            ctx.arc(sparkX + Math.cos(angle) * dist, sparkY + Math.sin(angle) * dist, 2, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(255, 220, 100, ${0.8 - dist/25})`;
            ctx.fill();
        }
    }

    // Damage cracks on boxer (accumulating)
    if (damage > 100) {
        const numCracks = Math.min(8, Math.floor(damage / 50));
        for (let i = 0; i < numCracks; i++) {
            const cx = boxerX - 10 + Math.sin(i * 2.3) * 15;
            const cy = boxerY - 60 * boxerScale + Math.cos(i * 1.7) * 20;
            ctx.beginPath();
            ctx.moveTo(cx, cy);
            ctx.lineTo(cx + Math.sin(i) * 8, cy + Math.cos(i) * 8);
            ctx.strokeStyle = `rgba(255, 50, 50, ${Math.min(0.6, damage / 500)})`;
            ctx.lineWidth = 1.5;
            ctx.stroke();
        }
    }
}

function drawBoxer(ctx, x, y, scale, phase, t) {
    const s = scale;

    // Body
    ctx.beginPath();
    ctx.ellipse(x, y - 20 * s, 22 * s, 35 * s, 0, 0, Math.PI * 2);

    // Color split - left red, right blue
    ctx.save();
    ctx.clip();
    ctx.fillStyle = 'rgba(41, 128, 185, 0.6)';
    ctx.fillRect(x, y - 60 * s, 30 * s, 80 * s);
    ctx.fillStyle = 'rgba(192, 57, 43, 0.6)';
    ctx.fillRect(x - 30 * s, y - 60 * s, 30 * s, 80 * s);
    ctx.restore();

    ctx.strokeStyle = '#888';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.ellipse(x, y - 20 * s, 22 * s, 35 * s, 0, 0, Math.PI * 2);
    ctx.stroke();

    // Split line down center
    ctx.beginPath();
    ctx.moveTo(x, y - 55 * s);
    ctx.lineTo(x, y + 15 * s);
    ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
    ctx.lineWidth = 1;
    ctx.setLineDash([3, 3]);
    ctx.stroke();
    ctx.setLineDash([]);

    // Head
    ctx.beginPath();
    ctx.arc(x, y - 65 * s, 18 * s, 0, Math.PI * 2);
    ctx.save();
    ctx.clip();
    ctx.fillStyle = 'rgba(41, 128, 185, 0.5)';
    ctx.fillRect(x, y - 85 * s, 20 * s, 40 * s);
    ctx.fillStyle = 'rgba(192, 57, 43, 0.5)';
    ctx.fillRect(x - 20 * s, y - 85 * s, 20 * s, 40 * s);
    ctx.restore();
    ctx.beginPath();
    ctx.arc(x, y - 65 * s, 18 * s, 0, Math.PI * 2);
    ctx.strokeStyle = '#888';
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // Split line on head
    ctx.beginPath();
    ctx.moveTo(x, y - 83 * s);
    ctx.lineTo(x, y - 47 * s);
    ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
    ctx.lineWidth = 1;
    ctx.setLineDash([2, 2]);
    ctx.stroke();
    ctx.setLineDash([]);

    // Right arm (throwing at bag)
    const rightArmAngle = punchFrame > 5 ? -0.8 : -0.3;
    const rightArmLen = punchFrame > 5 ? 50 * s : 35 * s;
    ctx.beginPath();
    ctx.moveTo(x + 15 * s, y - 25 * s);
    const rax = x + 15 * s + Math.cos(rightArmAngle) * rightArmLen;
    const ray = y - 25 * s + Math.sin(rightArmAngle) * rightArmLen;
    ctx.lineTo(rax, ray);
    ctx.strokeStyle = '#2980b9';
    ctx.lineWidth = 6 * s;
    ctx.lineCap = 'round';
    ctx.stroke();

    // Right glove
    ctx.beginPath();
    ctx.arc(rax, ray, 8 * s, 0, Math.PI * 2);
    ctx.fillStyle = '#3498db';
    ctx.fill();

    // Left arm (hitting own face)
    const leftArmAngle = punchFrame > 8 ? -2.2 : -2.8;
    const leftArmLen = punchFrame > 8 ? 45 * s : 30 * s;
    ctx.beginPath();
    ctx.moveTo(x - 15 * s, y - 25 * s);
    const lax = x - 15 * s + Math.cos(leftArmAngle) * leftArmLen;
    const lay = y - 25 * s + Math.sin(leftArmAngle) * leftArmLen;
    ctx.lineTo(lax, lay);
    ctx.strokeStyle = '#c0392b';
    ctx.lineWidth = 6 * s;
    ctx.lineCap = 'round';
    ctx.stroke();

    // Left glove
    ctx.beginPath();
    ctx.arc(lax, lay, 8 * s, 0, Math.PI * 2);
    ctx.fillStyle = '#e74c3c';
    ctx.fill();

    // Labels
    ctx.font = (10 * s) + 'px Georgia';
    ctx.textAlign = 'center';
    ctx.fillStyle = '#e74c3c';
    ctx.fillText('"Enemy"', x - 25 * s, y + 25 * s);
    ctx.fillStyle = '#3498db';
    ctx.fillText('"Me"', x + 25 * s, y + 25 * s);

    // Legs
    ctx.beginPath();
    ctx.moveTo(x - 8, y + 12 * s);
    ctx.lineTo(x - 15, y + 50 * s);
    ctx.moveTo(x + 8, y + 12 * s);
    ctx.lineTo(x + 15, y + 50 * s);
    ctx.strokeStyle = '#666';
    ctx.lineWidth = 5 * s;
    ctx.stroke();
}

function drawKnockedOutBoxer(ctx, x, y, scale, progress) {
    const fallProgress = Math.min(1, (progress - 0.5) * 3);
    const angle = fallProgress * Math.PI / 2;

    ctx.save();
    ctx.translate(x, y + 20);
    ctx.rotate(angle);

    // Simplified fallen body
    ctx.beginPath();
    ctx.ellipse(0, -20, 22 * scale, 35 * scale, 0, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(100, 60, 60, 0.5)';
    ctx.fill();
    ctx.strokeStyle = '#666';
    ctx.lineWidth = 1;
    ctx.stroke();

    // Head
    ctx.beginPath();
    ctx.arc(0, -65 * scale, 18 * scale, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(100, 60, 60, 0.4)';
    ctx.fill();
    ctx.strokeStyle = '#666';
    ctx.stroke();

    // Stars
    if (fallProgress > 0.5) {
        for (let i = 0; i < 3; i++) {
            const sx = Math.cos(t * 0.05 + i * 2.1) * 25;
            const sy = -75 * scale + Math.sin(t * 0.07 + i * 1.7) * 10;
            ctx.font = '14px serif';
            ctx.fillStyle = '#f0c040';
            ctx.fillText('★', sx, sy);
        }
    }

    ctx.restore();

    // "10... 9... 8..." count
    if (fallProgress > 0.7) {
        const count = 10 - Math.floor((fallProgress - 0.7) * 30);
        if (count > 0) {
            ctx.font = 'bold 28px Georgia';
            ctx.textAlign = 'center';
            ctx.fillStyle = '#fff';
            ctx.fillText(count + '...', x, y - 100);
        }
    }
}

function drawPromoter(ctx, x, y, phase, t, progress) {
    // Shadowy figure with distinctive hair/coat
    const bobble = Math.sin(t * 0.05) * 3;

    // Body (fur coat)
    ctx.beginPath();
    ctx.ellipse(x, y + bobble, 28, 40, 0, 0, Math.PI * 2);
    const furGrad = ctx.createRadialGradient(x, y + bobble, 0, x, y + bobble, 35);
    furGrad.addColorStop(0, 'rgba(100, 70, 30, 0.6)');
    furGrad.addColorStop(1, 'rgba(60, 40, 15, 0.3)');
    ctx.fillStyle = furGrad;
    ctx.fill();

    // Head
    ctx.beginPath();
    ctx.arc(x, y - 45 + bobble, 16, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(160, 120, 80, 0.5)';
    ctx.fill();

    // Wild hair
    for (let i = 0; i < 7; i++) {
        const angle = -Math.PI * 0.8 + (i / 6) * Math.PI * 0.6;
        ctx.beginPath();
        ctx.moveTo(x + Math.cos(angle) * 12, y - 50 + bobble + Math.sin(angle) * 12);
        ctx.lineTo(x + Math.cos(angle) * (22 + Math.sin(t * 0.1 + i) * 3), y - 55 + bobble + Math.sin(angle) * 22);
        ctx.strokeStyle = 'rgba(180, 150, 100, 0.5)';
        ctx.lineWidth = 2;
        ctx.stroke();
    }

    // Money signs floating up
    if (punchFrame > 5) {
        for (let i = 0; i < 2; i++) {
            const my = y - 70 + bobble - (15 - punchFrame) * 3 - i * 15;
            const mx = x + (i - 0.5) * 20;
            ctx.font = '14px Georgia';
            ctx.fillStyle = `rgba(240, 192, 64, ${punchFrame / 15})`;
            ctx.textAlign = 'center';
            ctx.fillText('$', mx, my);
        }
    }

    // Smile (gets bigger as profit grows)
    const smileWidth = Math.min(12, 5 + profit / 50);
    ctx.beginPath();
    ctx.arc(x, y - 42 + bobble, smileWidth, 0.1, Math.PI - 0.1);
    ctx.strokeStyle = `rgba(240, 192, 64, ${Math.min(0.8, 0.3 + profit / 200)})`;
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // Speech bubble (the lie)
    const lies = [
        '',
        '',
        '',
        '"That other hand is your enemy."',
        '"Hit harder. Show him who\'s boss."',
        '"You\'re a champion. Don\'t stop."',
        '"The crowd loves it. Keep going."',
        '"You\'re a champion. Don\'t stop now."',
        '"...doesn\'t matter. I have the shelter."'
    ];
    if (phase >= 2 && phase < lies.length && lies[phase]) {
        const bubbleX = x - 60;
        const bubbleY = y - 80 + bobble;
        const text = lies[phase];
        ctx.font = '10px Georgia';
        const tw = ctx.measureText(text).width + 16;

        // Bubble background
        ctx.beginPath();
        ctx.roundRect(bubbleX - tw/2, bubbleY - 12, tw, 22, 4);
        ctx.fillStyle = 'rgba(40, 35, 20, 0.85)';
        ctx.fill();
        ctx.strokeStyle = 'rgba(240, 192, 64, 0.4)';
        ctx.lineWidth = 1;
        ctx.stroke();

        // Bubble text
        ctx.textAlign = 'center';
        ctx.fillStyle = '#f0c040';
        ctx.fillText(text, bubbleX, bubbleY + 2);
    }

    // Label
    ctx.font = '11px Georgia';
    ctx.textAlign = 'center';
    ctx.fillStyle = '#f0c040';
    ctx.fillText('The Promoter', x, y + 55);
    if (profit > 0) {
        ctx.fillStyle = '#999';
        ctx.fillText('$10 per punch', x, y + 70);
    }
}

function drawWeapon(ctx, x, y, type, t) {
    const bob = Math.sin(t * 0.06) * 2;
    ctx.save();
    ctx.globalAlpha = 0.8;
    if (type === 'rifle') {
        // Simple rifle icon
        ctx.strokeStyle = '#aaa';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(x - 15, y + bob);
        ctx.lineTo(x + 20, y + bob);
        ctx.stroke();
        // barrel
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(x + 20, y + bob);
        ctx.lineTo(x + 35, y - 2 + bob);
        ctx.stroke();
        // stock
        ctx.beginPath();
        ctx.moveTo(x - 15, y + bob);
        ctx.lineTo(x - 22, y + 8 + bob);
        ctx.stroke();
        // label
        ctx.font = '9px Georgia';
        ctx.fillStyle = '#e74c3c';
        ctx.textAlign = 'center';
        ctx.fillText('1700s: rifle', x + 5, y + 22 + bob);
    } else if (type === 'nuke') {
        // Radiation symbol
        const cx = x + 5, cy = y + bob;
        ctx.strokeStyle = '#f0c040';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(cx, cy, 12, 0, Math.PI * 2);
        ctx.stroke();
        ctx.beginPath();
        ctx.arc(cx, cy, 4, 0, Math.PI * 2);
        ctx.fillStyle = '#f0c040';
        ctx.fill();
        // trefoil segments
        for (let i = 0; i < 3; i++) {
            const a = (i * 2.094) - Math.PI / 2;
            ctx.beginPath();
            ctx.arc(cx, cy, 12, a - 0.4, a + 0.4);
            ctx.lineTo(cx + Math.cos(a) * 5, cy + Math.sin(a) * 5);
            ctx.closePath();
            ctx.fillStyle = 'rgba(240, 192, 64, 0.6)';
            ctx.fill();
        }
        // label
        ctx.font = '9px Georgia';
        ctx.fillStyle = '#e74c3c';
        ctx.textAlign = 'center';
        ctx.fillText('NOW: nuke', cx, cy + 22);
    }
    ctx.restore();
}

function drawShelter(ctx, x, y, phase, t) {
    ctx.save();
    ctx.globalAlpha = phase >= 8 ? 0.7 : 0.5;
    // Bunker shape
    ctx.fillStyle = '#444';
    ctx.beginPath();
    ctx.arc(x, y - 8, 30, Math.PI, 0);
    ctx.lineTo(x + 30, y + 8);
    ctx.lineTo(x - 30, y + 8);
    ctx.closePath();
    ctx.fill();
    ctx.strokeStyle = '#666';
    ctx.lineWidth = 1.5;
    ctx.stroke();
    // Door
    ctx.fillStyle = '#333';
    ctx.fillRect(x - 8, y - 5, 16, 13);
    // Label
    ctx.font = '9px Georgia';
    ctx.fillStyle = '#f0c040';
    ctx.textAlign = 'center';
    ctx.fillText('Promoter\'s Shelter', x, y + 22);
    if (phase >= 8) {
        // Red X through it
        ctx.strokeStyle = 'rgba(231, 76, 60, 0.7)';
        ctx.lineWidth = 2.5;
        ctx.beginPath();
        ctx.moveTo(x - 25, y - 15);
        ctx.lineTo(x + 25, y + 15);
        ctx.moveTo(x + 25, y - 15);
        ctx.lineTo(x - 25, y + 15);
        ctx.stroke();
        ctx.font = '9px Georgia';
        ctx.fillStyle = '#e74c3c';
        ctx.fillText('Won\'t save him', x, y + 34);
    }
    ctx.restore();
}

function animate() {
    if (!running) return;

    drawScene();

    t++;
    const currentPhase = phases[phase];

    if (t >= currentPhase.duration) {
        t = 0;
        phase++;
        if (phase >= phases.length) {
            running = false;
            document.getElementById('playBtn').textContent = 'Replay';
            // Show moral
            document.getElementById('moral').style.display = 'block';
            return;
        }
        document.getElementById('narration').innerHTML = phases[phase].narration;
        document.getElementById('phaseLabel').textContent = phases[phase].label;
    }

    animFrame = requestAnimationFrame(animate);
}

function startAnimation() {
    if (phase >= phases.length) resetAnimation();
    running = true;
    document.getElementById('narration').innerHTML = phases[phase].narration;
    document.getElementById('phaseLabel').textContent = phases[phase].label;
    document.getElementById('playBtn').textContent = 'Playing...';
    document.getElementById('moral').style.display = 'none';
    animate();
}

function resetAnimation() {
    running = false;
    if (animFrame) cancelAnimationFrame(animFrame);
    phase = 0; t = 0;
    strength = 100; damage = 0; profit = 0;
    punchFrame = -1; hitFlash = 0; knockedOut = false;
    document.getElementById('strengthVal').textContent = '100';
    document.getElementById('damageVal').textContent = '0';
    document.getElementById('profitVal').textContent = '$0';
    document.getElementById('playBtn').textContent = 'Play';
    document.getElementById('narration').innerHTML = 'Press <strong>Play</strong> to enter the ring.';
    document.getElementById('phaseLabel').textContent = 'ROUND 1 OF 9';
    document.getElementById('moral').style.display = 'none';
    ctx.clearRect(0, 0, W, H);
    drawScene();
}

// Initial draw
drawScene();
</script>

</body>
</html>
